#!/bin/bash

ulimit -c unlimited

case `hostname` in
#  node502)	DISPLAY=:0 GPU_FORCE_64BIT_PTR=0 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU AARTFAAC/AARTFAAC -p1 -n288 -t3072 -c64 -d1 -g0 -b16 -s8 -R1 -r86400 -i 10.149.5.2:4000,10.149.5.2:4001,10.149.5.2:4002,10.149.5.2:4003,10.149.5.2:4004,10.149.5.2:4005 -o null:,null:,null:,null:,null:,null:,null:,null: -N 4-9,24-29/14-19,34-39 -A 0:3,1:3 -O 0:4,1:4
#		;;
#
#  node504)	LLVM_BIN=/opt/amdgpu-pro/bin PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU AARTFAAC/AARTFAAC -p1 -n288 -t3072 -c64 -d1 -g0 -b16 -s8 -R1 -r3 -i 10.149.5.4:4000,10.149.5.4:4001,10.149.5.4:4002,10.149.5.4:4003,10.149.5.4:4004,10.149.5.4:4005 -o null:,null:,null:,null:,null:,null:,null:,null: -N 4-9,24-29/14-19,34-39 -A 0:3,1:3 -O 0:4,1:4
#		;;

  fs5|node5??)
		DATA="/var/scratch/romein/AARTFAAC-raw/Mon Aug  9 13:08:40 UTC 2021"
		TZ=UTC srun --gres=gpu:2 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C8 -b16 -s8 -m15 -D '2021-08-09 13:08:40' -r4 -g0-1 -q1 -R0 -S166,167,185,186,194,195,320,321 -i "`seq -s, -f\"file:$DATA/raw-sb00-st%02g\" 0 11`" -o "file:$DATA/a12-sb166.vis","file:$DATA/a12-sb167.vis","file:$DATA/a12-sb185.vis","file:$DATA/a12-sb186.vis","file:$DATA/a12-sb194.vis","file:$DATA/a12-sb195.vis","file:$DATA/a12-sb320.vis","file:$DATA/a12-sb321.vis"
		TZ=UTC srun --gres=gpu:2 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C8 -b16 -s8 -m15 -D '2021-08-09 13:08:40' -r4 -g0-1 -q1 -R0 -S210,211,212,213,235,236,237,238 -i "`seq -s, -f\"file:$DATA/raw-sb08-st%02g\" 0 11`" -o "file:$DATA/a12-sb210.vis","file:$DATA/a12-sb211.vis","file:$DATA/a12-sb212.vis","file:$DATA/a12-sb213.vis","file:$DATA/a12-sb235.vis","file:$DATA/a12-sb236.vis","file:$DATA/a12-sb237.vis","file:$DATA/a12-sb238.vis"

		DATA="/var/scratch/romein/AARTFAAC-raw/Tue Aug 10 09:02:12 UTC 2021"
		TZ=UTC srun --gres=gpu:1 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C8 -b16 -s8 -m15 -D '2021-08-10 09:02:12' -r4 -g0 -q1 -R0 -S166,167,185,186,194,195,320,321 -i "`seq -s, -f\"file:$DATA/raw-sb00-st%02g\" 0 11`" -o "file:$DATA/a12-sb166.vis","file:$DATA/a12-sb167.vis","file:$DATA/a12-sb185.vis","file:$DATA/a12-sb186.vis","file:$DATA/a12-sb194.vis","file:$DATA/a12-sb195.vis","file:$DATA/a12-sb320.vis","file:$DATA/a12-sb321.vis"
		TZ=UTC srun --gres=gpu:1 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C8 -b16 -s8 -m15 -D '2021-08-10 09:02:12' -r4 -g0 -q1 -R0 -S210,211,212,213,235,236,237,238 -i "`seq -s, -f\"file:$DATA/raw-sb08-st%02g\" 0 11`" -o "file:$DATA/a12-sb210.vis","file:$DATA/a12-sb211.vis","file:$DATA/a12-sb212.vis","file:$DATA/a12-sb213.vis","file:$DATA/a12-sb235.vis","file:$DATA/a12-sb236.vis","file:$DATA/a12-sb237.vis","file:$DATA/a12-sb238.vis"

		TZ=UTC srun --gres=gpu:1 AARTFAAC/AARTFAAC -p1 -n576 -t384 -I2 -c256 -C8 -b16 -s8 -m15 -D '2021-08-10 09:22:57' -r6 -g0 -q1 -R0 -S166,167,185,186,194,195,320,321 -i 'file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st00','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st01','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st02','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st03','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st04','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st05','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st06','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st07','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st08','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st09','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st10','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st11' -o 'file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb166.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb167.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb185.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb186.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb194.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb195.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb320.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb321.vis'
  		TZ=UTC srun --gres=gpu:1 AARTFAAC/AARTFAAC -p1 -n576 -t384 -I2 -c256 -C8 -b16 -s8 -m15 -D '2021-08-10 09:22:57' -r6 -g0 -q1 -R0 -S210,211,212,213,235,236,237,238 -i 'file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st00','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st01','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st02','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st03','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st04','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st05','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st06','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st07','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st08','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st09','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st10','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st11' -o 'file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb210.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb211.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb212.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb213.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb235.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb236.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb237.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a12-sb238.vis'
  		TZ=UTC srun --gres=gpu:1 AARTFAAC/AARTFAAC -p1 -n288 -t384 -I2 -c256 -C8 -b16 -s8 -m15 -D '2021-08-10 09:22:57' -r6 -g0 -q1 -R0 -S166,167,185,186,194,195,320,321 -i 'file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st00','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st01','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st02','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st03','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st04','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb00-st05' -o 'file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb166.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb167.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb185.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb186.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb194.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb195.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb320.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb321.vis'
  		TZ=UTC srun --gres=gpu:1 AARTFAAC/AARTFAAC -p1 -n288 -t384 -I2 -c256 -C8 -b16 -s8 -m15 -D '2021-08-10 09:22:57' -r6 -g0 -q1 -R0 -S210,211,212,213,235,236,237,238 -i 'file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st00','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st01','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st02','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st03','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st04','file:/var/scratch/romein/AARTFAAC-raw/data/raw-sb08-st05' -o 'file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb210.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb211.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb212.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb213.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb235.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb236.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb237.vis','file:/var/scratch/romein/AARTFAAC-raw/data/a06-sb238.vis'
		;;

  gpu02)	DISPLAY=:0 GPU_FORCE_64BIT_PTR=0 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU numactl -C 10-19 AARTFAAC/installed/AARTFAAC -p1 -n288 -t3072 -c64 -d1 -g0,1 -b16 -s8 -R1 -r86400 -i 10.195.100.1:53268,10.195.100.1:53276,10.195.100.1:53284,10.195.100.1:53292,10.195.100.1:53300,10.195.100.1:53308 -o null:,null:,null:,null:,null:,null:,null:,null:
		;;

  phi)		DISPLAY=:0 GPU_FORCE_64BIT_PTR=0 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU numactl --cpunodebind=1 AARTFAAC/installed/AARTFAAC -p1 -n288 -t1808 -c64 -d1 -g0,1 -b16 -s1 -R0 -r4 -i file:/var/scratch/romein/aartfaac-test,file:/var/scratch/romein/aartfaac-test,file:/var/scratch/romein/aartfaac-test,file:/var/scratch/romein/aartfaac-test,file:/var/scratch/romein/aartfaac-test,file:/var/scratch/romein/aartfaac-test -o file:/var/scratch/romein/aartfaac-out "$@"
  		;;

  #agc001)	GPU_FORCE_64BIT_PTR=1 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU numactl -i 0,1 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C15 -d1 -g0-9 -b16 -s8 -r60 -i 10.195.100.1:53269,10.195.100.1:53277,10.195.100.1:53285,10.195.100.1:53293,10.195.100.1:53301,10.195.100.1:53309,10.195.100.2:53317,10.195.100.2:53325,10.195.100.2:53333,10.195.100.2:53341,10.195.100.2:53349,10.195.100.2:53357 -o null:,null:,null:,null:,null:,null:,null:,null: -N 4-11,28-35/16-23,40-47 -A 0:6,1:6 -O 0:4,1:4 "$@"
  agc001)	GPU_FORCE_64BIT_PTR=1 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU numactl -i 0,1 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C56 -d1 -g0-9 -b16 -s8 -r30 -i 10.195.100.1:53269,10.195.100.1:53277,10.195.100.1:53285,10.195.100.1:53293,10.195.100.1:53301,10.195.100.1:53309,10.195.100.2:53317,10.195.100.2:53325,10.195.100.2:53333,10.195.100.2:53341,10.195.100.2:53349,10.195.100.2:53357 -o tcp:10.195.100.40:4000,tcp:10.195.100.40:4001,tcp:10.195.100.40:4002,tcp:10.195.100.40:4003,tcp:10.195.100.50:4000,tcp:10.195.100.50:4001,tcp:10.195.100.50:4002,tcp:10.195.100.50:4003 -N 4-11,28-35/16-23,40-47 -A 0:6,1:6 -O 0:4,1:4 "$@"
		;;

  agc002)	GPU_FORCE_64BIT_PTR=1 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU numactl -i 0,1 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C15 -d1 -g0-9 -b16 -s8 -r60 -i 10.195.100.3:53268,10.195.100.3:53276,10.195.100.3:53284,10.195.100.3:53292,10.195.100.3:53300,10.195.100.3:53308,10.195.100.4:53316,10.195.100.4:53324,10.195.100.4:53332,10.195.100.4:53340,10.195.100.4:53348,10.195.100.4:53356 -o null:,null:,null:,null:,null:,null:,null:,null: -N 4-11,28-35/16-23,40-47 -A 0:6,1:6 -O 0:4,1:4 "$@"
  #agc002)	GPU_FORCE_64BIT_PTR=1 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU numactl -i 0,1 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C15 -d1 -g0-9 -b16 -s8 -r10 -i 10.195.100.3:53268,10.195.100.3:53276,10.195.100.3:53284,10.195.100.3:53292,10.195.100.3:53300,10.195.100.3:53308,10.195.100.4:53316,10.195.100.4:53324,10.195.100.4:53332,10.195.100.4:53340,10.195.100.4:53348,10.195.100.4:53356 -o tcp:10.195.100.40:4000,tcp:10.195.100.40:4001,tcp:10.195.100.40:4002,tcp:10.195.100.40:4003,tcp:10.195.100.50:4000,tcp:10.195.100.50:4001,tcp:10.195.100.50:4002,tcp:10.195.100.50:4003 -N 4-11,28-35/16-23,40-47 -A 0:6,1:6 -O 0:4,1:4 "$@"
  #agc002)	GPU_FORCE_64BIT_PTR=1 PLATFORM="AMD Accelerated Parallel Processing" TYPE=GPU numactl -i 0-1 AARTFAAC/AARTFAAC -p1 -n576 -t768 -c256 -C15 -d1 -g0-9 -b16 -s8 -r60 -i 10.195.100.3:53268,10.195.100.3:53276,10.195.100.3:53284,10.195.100.3:53292,10.195.100.3:53300,10.195.100.3:53308,10.195.100.4:53316,10.195.100.4:53324,10.195.100.4:53332,10.195.100.4:53340,10.195.100.4:53348,10.195.100.4:53356 -o tcp:10.195.100.30:4100,tcp:10.195.100.30:4101,tcp:10.195.100.30:4102,tcp:10.195.100.30:4103,tcp:10.195.100.31:4104,tcp:10.195.100.31:4105,tcp:10.195.100.31:4106,tcp:10.195.100.31:4107 -N 4-11,28-35/16-23,40-47 -A 0:6,1:6 -O 0:4,1:4 "$@"
		;;

esac
